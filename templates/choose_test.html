{% extends 'base.html' %}

{% block title %}
Ch·ªçn b√†i {{ current_category }} - Luy·ªán Thi IELTS
{% endblock %}

{% block content %}
<div class="flex flex-col md:flex-row gap-8">

    <!-- ===== C·ªòT B√äN TR√ÅI (SIDEBAR) ===== -->
    <aside class="w-full md:w-1/4 lg:w-1/5 bg-white p-6 rounded-lg shadow-md flex-shrink-0">
        <h2 class="text-xl font-semibold mb-4 text-gray-800">Danh m·ª•c</h2>

        <!-- M·ª•c Reading -->
        <div class="mb-5">
            <!-- (S·ª¨A) S·ª≠a url_for th√†nh 'choose_test' -->
            <a href="{{ url_for('test.choose_test', category='Reading') }}"
                class="text-lg font-medium {% if current_category == 'Reading' %} text-blue-600 {% else %} text-gray-700 hover:text-blue-600 {% endif %}">
                üìö Reading Tests
            </a>
            {% if latest_reading %}
            <ul class="mt-2 ml-4 space-y-1 text-sm list-disc list-inside">
                {% for test in latest_reading %}
                <li>
                    <!-- (TH√äM) Th√™m link t·ªõi trang l√†m b√†i Reading -->
                    <a href="{{ url_for('test.reading_test_page', test_id=test.id) }}"
                        class="text-gray-600 hover:text-blue-500 hover:underline">
                        {{ test.title }}
                    </a>
                </li>
                {% endfor %}
            </ul>
            {% endif %}
        </div>

        <!-- M·ª•c Listening -->
        <div>
            <!-- (S·ª¨A) S·ª≠a url_for th√†nh 'choose_test' -->
            <a href="{{ url_for('test.choose_test', category='Listening') }}"
                class="text-lg font-medium {% if current_category == 'Listening' %} text-green-600 {% else %} text-gray-700 hover:text-green-600 {% endif %}">
                üéß Listening Tests
            </a>
            {% if latest_listening %}
            <ul class="mt-2 ml-4 space-y-1 text-sm list-disc list-inside">
                {% for test in latest_listening %}
                <li>
                    <!-- (TH√äM) Th√™m link t·ªõi trang l√†m b√†i Listening -->
                    <a href="{{ url_for('test.listening_test_page', test_id=test.id) }}"
                        class="text-gray-600 hover:text-green-500 hover:underline">
                        {{ test.title }}
                    </a>
                </li>
                {% endfor %}
            </ul>
            {% endif %}
        </div>

    </aside>

    <!-- ===== C·ªòT B√äN PH·∫¢I (MAIN CONTENT) ===== -->
    <main class="flex-1">
        <div class="flex justify-between items-center mb-6">
            <h1 id="selection-title" class="text-3xl font-bold text-gray-900">
                Ch·ªçn b√†i {{ current_category }} Test
            </h1>
            <a href="{{ url_for('index') }}" class="text-blue-600 hover:text-blue-800 font-medium hidden md:block">
                &larr; Quay l·∫°i Trang ch·ªß
            </a>
        </div>

        {% if tests %}
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- L·∫∑p qua danh s√°ch c√°c test c·ªßa category hi·ªán t·∫°i -->
            {% for test in tests %}
            <div
                class="test-card bg-white p-6 rounded-lg shadow-lg hover:shadow-xl transition duration-300 flex flex-col justify-between">
                <div>
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">{{ test.title }}</h3>
                    <!-- B·∫°n c√≥ th·ªÉ th√™m c·ªôt 'topic' ho·∫∑c 'description' v√†o model Test n·∫øu mu·ªën -->
                    <!-- <p class="text-gray-600 mb-4">{{ test.topic if test.topic else 'Ch∆∞a c√≥ m√¥ t·∫£' }}</p> -->
                </div>
                {% if current_category == 'Reading' %}
                <!-- (TH√äM) Link t·ªõi trang thi, d√πng endpoint ƒë·ªông -->
                <a href="{{ url_for('test.reading_test_page', test_id=test.id) }}"
                    class="mt-4 inline-block bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700">
                    L√†m b√†i
                </a>
                {% elif current_category == 'Listening' %}
                <!-- (TH√äM) Link t·ªõi trang thi, d√πng endpoint ƒë·ªông -->  
                <a href="{{ url_for('test.listening_test_page', test_id=test.id) }}"
                    class="mt-4 inline-block bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700">
                    L√†m b√†i
                </a>
                {% endif %}
            </div>
            {% endfor %}
        </div>
        {% else %}
        <!-- Hi·ªÉn th·ªã n·∫øu kh√¥ng c√≥ test n√†o trong category n√†y -->
        <div class="bg-white p-6 rounded-lg shadow-md text-center">
            <p class="text-gray-600 italic">Ch∆∞a c√≥ b√†i test n√†o ƒë∆∞·ª£c th√™m cho m·ª•c {{ current_category }}.</p>
        </div>
        {% endif %}
    </main>
</div>
{% endblock %}